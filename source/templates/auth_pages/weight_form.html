{% extends "base_layouts/base_auth.html" %}
{% block title %}{{ site_name }} | {% if weight %}Update Weight{% else %}Add Weight{% endif %}{% endblock %}
{% block content %}

<style>
    .readonly-background {
        background-color: #f7fbfb !important;
    }
</style>

<div class="row">
    <div class="col-lg-12">
        <h2 class="page-header page-header-title">{% if weight %}Update Weight{% else %}Add Weight Entry{% endif %}</h2>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                {% if weight %}Update Weight Entry{% else %}Add New Weight Entry{% endif %}
            </div>
            <div class="panel-body">
                <div class="row">
                    {% if msg_error is not none %}
                    <div class="col-lg-12">
                        <div class="alert alert-danger">{{ msg_error }}</div>
                    </div>
                    {% endif %}
                    
                    {% if msg_success is not none %}
                    <div class="col-lg-12">
                        <div class="alert alert-success">{{ msg_success }}</div>
                    </div>
                    {% endif %}

                    <div class="col-lg-6">
                        <form id="form_weight" name="form_weight" role="form" method="post" 
                            action="{% if weight %}/weight-update/{{ weight.weight_uuid }}{% else %}/weight-add{% endif %}">

                            <!-- Data Object Selection -->
                            <div class="form-group">
                                <label class="form-label">Data Object <span style="color: red;">*</span></label>
                                <select name="weight_data_object_uuid" class="form-control" required>
                                    <option value="">-- Select Data Object --</option>
                                    {% for obj in data_objects %}
                                        <option value="{{ obj.data_object_uuid }}" 
                                            {% if weight and weight.weight_data_object_uuid == obj.data_object_uuid %}selected{% endif %}>
                                            {{ obj.data_object_name }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>

                            <!-- Weight Value -->
                            <div class="form-group">
                                <label class="form-label">Weight Value <span style="color: red;">*</span></label>
                                <input type="number" 
                                       name="weight_val" 
                                       class="form-control" 
                                       value="{% if weight %}{{ weight.weight_val }}{% endif %}" 
                                       placeholder="Enter weight value" 
                                       step="0.01"
                                       required>
                                <small class="form-text text-muted">Enter the weight value (numeric)</small>
                            </div>

                            <!-- Weight Timestamp -->
                            <div class="form-group">
                                <label class="form-label">Date & Time <span style="color: red;">*</span></label>
                                <input type="datetime-local" 
                                       name="weight_timestamp" 
                                       class="form-control" 
                                       value="{% if weight %}{{ weight.weight_timestamp | replace({' ': 'T'}) }}{% else %}{{ 'now' | date('Y-m-d\\TH:i') }}{% endif %}" 
                                       required>
                                <small class="form-text text-muted">Enter the date and time of the weight measurement</small>
                            </div>

                            <!-- Created On (Read-only if updating) %}
                            {% if weight %}
                            <div class="form-group">
                                <label class="form-label">Created On</label>
                                <input type="text" 
                                       class="form-control readonly-background" 
                                       value="{{ weight.created_on }}" 
                                       disabled>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Created By</label>
                                <input type="text" 
                                       class="form-control readonly-background" 
                                       value="{{ weight.created_by }}" 
                                       disabled>
                            </div>
                            {% endif %}

                            <br/>

                            <!-- Hidden Fields -->
                            {% if weight and weight.weight_id %}
                            <input id="weight_id" name="weight_id" type="hidden" value="{{ weight.weight_id }}">
                            {% endif %}

                            {% if weight and weight.weight_uuid %}
                            <input id="weight_uuid" name="weight_uuid" type="hidden" value="{{ weight.weight_uuid }}">
                            {% endif %}

                            <input name="postback_weight" type="hidden" value="{% if weight %}update{% else %}create{% endif %}">

                            <!-- Submit and Reset Buttons -->
                            <button type="submit" class="btn btn-primary">Save</button>
                            <button type="reset" class="btn btn-secondary">Reset</button>
                            <a href="/weight-list" class="btn btn-default">Back to List</a>

                            <hr/>
                        </form>
                    </div>

                    <div class="col-lg-6">
                        <!-- Information Panel -->
                        <div class="panel panel-info">
                            <div class="panel-heading">Information</div>
                            <div class="panel-body">
                                <h4>Add Weight Entry</h4>
                                <p>Use this form to record a new weight entry for a selected data object.</p>
                                <ul>
                                    <li>Select the data object you want to track</li>
                                    <li>Enter the weight value</li>
                                    <li>Click "Save" to record the entry</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

